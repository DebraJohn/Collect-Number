{"version":3,"sources":["core/event.js","core/storage.js","components/CollectBoard/index.js","components/Dice/index.js","App.js","index.js"],"names":["core_event","EventEmitter","saveGame","boardData","key","val","JSON","stringify","localStorage","setItem","concat","getGame","parse","getItem","getRecord","CollectBoard","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","blockNum","toggle","prevPos","_this2","_this$state","blocks","map","row","vIndex","item","hIndex","react_default","a","createElement","className","onClick","handleChess","isArrayEqual","_this3","eventEmitter","Emitter","addListener","recievedNewNumber","v","h","switchChess","setState","currentPos","targetPos","cX","cY","tX","tY","currentValue","targetValue","arrA","arguments","length","undefined","arrB","toString","findVacentPos","x","y","console","log","i","result","findIndex","value","React","Component","Dice","summon","emit","createRandomNumber","chanceArr","createChanceArr","num","chance","Math","random","rule","basic","newArr","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","push","err","return","App","Dice_Dice","CollectBoard_CollectBoard","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.9d469a35.chunk.js","sourcesContent":["import EventEmitter from \"events\";\nexport default new EventEmitter();","const saveRecord = (key, val) => {\n  localStorage.setItem(`collectGame_${key}`, val)\n}\n\nconst getRecord = (key) => {\n  return localStorage.getItem(`collectGame_${key}`)\n}\n\nexport const saveGame = (boardData) => {\n  saveRecord('testPlayer1', JSON.stringify(boardData))\n}\n\nexport const getGame = (key) => {\n  return JSON.parse(getRecord(key))\n}","import React from 'react';\nimport './index.css'\nimport Emitter from '../../core/event'\nimport { saveGame, getGame } from '../../core/storage'\n\nexport default class CollectBoard extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      blockNum: getGame('testPlayer1') || [\n        [1, 0, 0],\n        [0, 0, 0],\n        [0, 0, 0]\n      ],\n      toggle: 0\n    }\n    this.prevPos = []\n    this.toggle = 0 // 1-拿起  0-放下\n  }\n  render() {\n    const { blockNum, toggle } = this.state;\n    const blocks = blockNum.map((row, vIndex) => (\n      row.map((item, hIndex) => (\n        <div className=\"block\" key={vIndex * 3 + hIndex} onClick={() => this.handleChess(vIndex, hIndex)}>\n          { item ? \n            <span className={`number${this.isArrayEqual(this.prevPos, [vIndex, hIndex]) && toggle ? ' lifted': ''}`}>\n              {item}\n            </span>\n          : '' }\n        </div>))\n    ))\n    return <div className=\"collect-board\">\n      {blocks}\n    </div>\n  }\n  componentDidMount() {\n    this.eventEmitter = Emitter.addListener('sendNumber', val => {\n      this.recievedNewNumber(val);\n    });\n  }\n  handleChess(v, h) {\n    const { toggle } = this.state;\n    toggle ? this.switchChess(this.prevPos, [v, h]) : this.prevPos = [v, h]\n    this.setState({ toggle: !toggle })\n  }\n\n  switchChess(currentPos, targetPos) {\n    if (this.isArrayEqual(currentPos, targetPos)) return // 拿起和放下如果是相同位置 则不处理\n\n    const { blockNum } = this.state;\n    const cX = currentPos[0], cY = [currentPos[1]]\n    const tX = targetPos[0], tY = [targetPos[1]]\n    const currentValue = blockNum[cX][cY], targetValue = blockNum[tX][tY]\n\n    // 相同数字合并，不同数字交换位置\n    blockNum[cX][cY] = currentValue !== targetValue \n        ? [targetValue, blockNum[tX][tY] = currentValue][0]\n        : [0, blockNum[tX][tY] = targetValue + currentValue][0]\n    \n    this.setState({ blockNum })\n    saveGame(blockNum)\n  }\n\n  isArrayEqual(arrA = [], arrB = []) {\n    return arrA.toString() === arrB.toString()\n  }\n\n  recievedNewNumber(val) {\n    const { blockNum } = this.state\n    const vacentPos = this.findVacentPos()\n    if (vacentPos) {\n      const x = this.findVacentPos()[0], y = this.findVacentPos()[1]\n      blockNum[x][y] = val;\n      this.setState({ blockNum })\n    } else {\n      // todo\n      console.log('位置已满')\n    }\n  }\n  findVacentPos() {\n    const { blockNum } = this.state\n    for (let i in blockNum) {\n      const result = blockNum[i].findIndex(value => value === 0)\n      if(result !== -1) {\n        return [i, result]\n      }\n    }\n  }\n}","import React from 'react';\nimport './index.css';\nimport Emitter from '../../core/event'\n\nexport default class Dice extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      \n    }\n  }\n  render() {\n    return <div className=\"dice\" onClick={() => this.summon()}>+</div>\n  }\n  summon() {\n    Emitter.emit('sendNumber', this.createRandomNumber());\n  }\n  createRandomNumber() {\n    const chanceRule = [\n      { num: 1, chance: 0.55 },\n      { num: 2, chance: 0.3 },\n      { num: 4, chance: 0.1 },\n      { num: 8, chance: 0.05 }\n    ]\n    const chanceArr = this.createChanceArr(chanceRule)\n    return chanceArr[~~(Math.random() * chanceArr.length)]\n  }\n\n  createChanceArr(rule, basic = 100) {\n    let newArr = [];\n    for (const item of rule) {\n      const { num, chance } = item;\n      for (let i = 0; i < chance * basic; i++) {\n        newArr.push(num);\n      }\n    }\n    return newArr;\n  }\n}","import React from 'react';\nimport CollectBoard from './components/CollectBoard'\nimport Dice from './components/Dice'\nimport './App.css'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Dice />\n      <CollectBoard />\n      {/* TODO: 九宫格组件、抽奖、画册 */}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}