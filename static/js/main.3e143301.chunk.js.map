{"version":3,"sources":["core/event.js","core/storage.js","components/CollectBoard/numberToIcon.js","components/CollectBoard/index.js","core/chance.js","components/Dice/index.js","components/Footer/index.js","App.js","index.js"],"names":["core_event","EventEmitter","saveGame","boardData","key","val","JSON","stringify","localStorage","setItem","concat","getGame","parse","getItem","getRecord","numberToIcon","1","2","4","8","16","32","64","128","256","512","1024","2048","4096","8192","16384","32768","65536","131072","262144","CollectBoard","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","colNum","vacentArea","state","blockNum","toggle","failed","prevPos","_this2","_this$state","blocks","map","row","vIndex","item","hIndex","react_default","a","createElement","className","onClick","handleChess","isArrayEqual","_this3","eventEmitter","Emitter","addListener","recievedNewNumber","deleteListener","setState","v","h","switchChess","currentPos","targetPos","_currentPos","slicedToArray","cX","cY","_targetPos","tX","tY","currentValue","targetValue","arrA","arguments","length","undefined","arrB","toString","vacentPos","findVacentPos","_vacentPos","x","y","Array","from","Set","flat","i","result","findIndex","value","React","Component","primaryNumber","createRandomNumber","chanceNumbers","_chanceNumbers","rule","basic","newArr","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","num","chance","push","err","return","Math","random","createChanceArr","Dice","delete","summon","maxNumber","max","apply","toConsumableArray","chanceArray","times","emit","removeItem","Footer","App","Dice_Dice","CollectBoard_CollectBoard","Footer_Footer","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.3e143301.chunk.js","sourcesContent":["import EventEmitter from \"events\";\nexport default new EventEmitter();","const saveRecord = (key, val) => {\n  localStorage.setItem(`collectGame_${key}`, val)\n}\n\nconst getRecord = (key) => {\n  return localStorage.getItem(`collectGame_${key}`)\n}\n\nexport const saveGame = (boardData) => {\n  saveRecord('testPlayer1', JSON.stringify(boardData))\n}\n\nexport const getGame = (key) => {\n  return JSON.parse(getRecord(key))\n}","// export const numberToIcon = {\n//   '1': 'xiaojitui',\n//   '2': 'baiputaogan',\n//   '4': 'shousimianbao',\n//   '8': 'zhurouchang',\n//   '16': 'yaoguo',\n//   '32': 'caomei',\n//   '64': 'baocuibinggan',\n//   '128': 'naiyouxiaweiyiguo',\n//   '256': 'mangguo',\n//   '512': 'songzi',\n//   '1024': 'banli',\n//   '2048': 'zhenzi',\n//   '4096': 'hongzao',\n//   '8192': 'huafubing',\n//   '16384': 'manyuemeiquqi',\n//   '32768': 'shanbei',\n//   '65536': 'bigenguo',\n//   '131072': 'kaixinguo',\n//   '262144': 'guaziren'\n// };\n\nexport const numberToIcon = {\n  '1': 'cake',\n  '2': 'pizza',\n  '4': 'popsicle',\n  '8': 'doughnut',\n  '16': 'macaron',\n  '32': 'sushi',\n  '64': 'hotdog',\n  '128': 'bread',\n  '256': 'chips',\n  '512': 'taco',\n  '1024': 'strawberry',\n  '2048': 'cookie',\n  '4096': 'pistachio',\n  '8192': 'popcorn',\n  '16384': 'pecan',\n  '32768': 'pudding',\n  '65536': 'mochi',\n  '131072': 'eggyolkcake',\n  '262144': 'cashew'\n};\n","import React from 'react';\nimport './index.css'\nimport Emitter from '../../core/event'\nimport { saveGame, getGame } from '../../core/storage'\n// import { createRandomNumber } from '../../core/chance'\nimport { numberToIcon } from './numberToIcon'\n\nexport default class CollectBoard extends React.Component {\n  constructor() {\n    super();\n    this.colNum = 3\n    this.vacentArea = this.colNum * this.colNum\n    this.state = {\n      blockNum: getGame('testPlayer1') || [\n        [1, 0, 0],\n        [0, 0, 0],\n        [0, 0, 0]\n      ],\n      toggle: 0,\n      failed: false\n    }\n    this.prevPos = []\n    this.toggle = 0 // 1-拿起  0-放下\n  }\n  render() {\n    const { blockNum, toggle,failed } = this.state;\n    const blocks = blockNum.map((row, vIndex) => (\n      row.map((item, hIndex) => (\n        <div className=\"block\" key={vIndex * this.colNum + hIndex} onClick={() => this.handleChess(vIndex, hIndex)}>\n          { item ? \n            <div className=\"itemWrap\">\n              <div className={`foodIcon${this.isArrayEqual(this.prevPos, [vIndex, hIndex]) && toggle ? ' lifted': ''}`}>\n                <i className={`icon ${numberToIcon[item]}`}></i>\n              </div>\n              <span className=\"number\">{item}</span>\n            </div>\n          : '' }\n        </div>))\n    ))\n    return <div className=\"collect-board\">\n      {failed ? '游戏结束，请重置' : blocks}\n    </div>\n  }\n  componentDidMount() {\n    this.eventEmitter = Emitter.addListener('sendNumber', val => {\n      this.recievedNewNumber(val);\n    });\n    this.deleteListener = Emitter.addListener('deleteNumber', () => {\n      this.setState({\n        blockNum: [[1, 0, 0],\n        [0, 0, 0],\n        [0, 0, 0]],\n        failed: false\n      })\n    });\n\n    // this.timer = setInterval(() => {\n    //   this.vacentArea === 0 && clearInterval(this.timer)\n    //   this.recievedNewNumber(createRandomNumber())\n    // }, 1000)\n  }\n  handleChess(v, h) {\n    const { toggle } = this.state;\n    toggle ? this.switchChess(this.prevPos, [v, h]) : this.prevPos = [v, h]\n    this.setState({ toggle: !toggle })\n  }\n\n  switchChess(currentPos, targetPos) {\n    if (this.isArrayEqual(currentPos, targetPos)) return // 拿起和放下如果是相同位置 则不处理\n\n    const { blockNum } = this.state;\n    const [ cX, cY ] = currentPos;\n    const [ tX, tY ] = targetPos;\n    const currentValue = blockNum[cX][cY], targetValue = blockNum[tX][tY];\n\n    // 相同数字合并，不同数字交换位置\n    blockNum[cX][cY] = currentValue !== targetValue \n        ? [targetValue, blockNum[tX][tY] = currentValue][0]\n        : [0, blockNum[tX][tY] = targetValue + currentValue][0]\n    \n    this.setState({ blockNum })\n    saveGame(blockNum)\n  }\n\n  isArrayEqual(arrA = [], arrB = []) {\n    return arrA.toString() === arrB.toString()\n  }\n\n  recievedNewNumber(val) {\n    const { blockNum } = this.state\n    const vacentPos = this.findVacentPos()\n    if (vacentPos) {\n      const [ x, y ] = vacentPos;\n      blockNum[x][y] = val;\n      this.setState({ blockNum })\n    } else {\n      // todo\n      this.vacentArea = 0\n      if (Array.from(new Set(blockNum.flat())).length === 9) {\n        this.setState({failed: true})\n      }\n    }\n    saveGame(blockNum)\n  }\n  findVacentPos() {\n    const { blockNum } = this.state\n    for (let i in blockNum) {\n      const result = blockNum[i].findIndex(value => value === 0)\n      if(result !== -1) {\n        return [i, result]\n      }\n    }\n  }\n}","const createChanceArr = (rule, basic = 100) => {\n  let newArr = [];\n  for (const item of rule) {\n    const { num, chance } = item;\n    for (let i = 0; i < chance * basic; i++) {\n      newArr.push(num);\n    }\n  }\n  return newArr[~~(Math.random() * newArr.length)];\n};\n\nexport const primaryNumber = [1, 2, 4, 8];\n\nexport const createRandomNumber = (chanceNumbers = primaryNumber) => {\n  const [ num1, num2, num3, num4 ] = chanceNumbers\n  const chanceRule = [\n    { num: num1, chance: 0.55 },\n    { num: num2, chance: 0.3 },\n    { num: num3, chance: 0.1 },\n    { num: num4, chance: 0.05 }\n  ];\n  return createChanceArr(chanceRule);\n};\n","import React from 'react';\nimport './index.css';\nimport { primaryNumber, createRandomNumber } from '../../core/chance';\nimport { getGame } from '../../core/storage'\nimport Emitter from '../../core/event';\n\nexport default class Dice extends React.Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n  render() {\n    return (\n      <div className=\"topActions\">\n        <div className=\"delete\" onClick={() => this.delete()}>\n          <i className=\"icon trashBin\" />\n          <span>重置</span>\n        </div>\n        <div className=\"dice\" onClick={() => this.summon()}>\n          <i className=\"icon weibolu\" />\n          <span>来一发</span>\n        </div>\n      </div>\n    );\n  }\n  summon() {\n    const maxNumber = getGame('testPlayer1') ? Math.max(...getGame('testPlayer1').flat()) : 8\n    let chanceArray = primaryNumber\n    if(maxNumber > 8) {\n      const times = maxNumber / primaryNumber[3]\n      chanceArray = primaryNumber.map(item => item * times)\n    }\n    Emitter.emit('sendNumber', createRandomNumber(chanceArray));\n  }\n  delete() {\n    Emitter.emit('deleteNumber', 'reStart');\n    localStorage.removeItem('collectGame_testPlayer1')\n  }\n}\n","import React from 'react';\nimport './index.css';\n\nexport default class Footer extends React.Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n  render() {\n    return (\n      <div className=\"footer\">\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport CollectBoard from './components/CollectBoard'\nimport Dice from './components/Dice'\nimport Footer from './components/Footer'\nimport './App.css'\nimport './assets/icon.css'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Dice />\n      <CollectBoard />\n      <Footer />\n      {/* TODO: 九宫格组件、抽奖、画册 */}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}