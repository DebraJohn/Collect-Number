{"version":3,"sources":["core/event.js","core/storage.js","core/chance.js","components/CollectBoard/numberToIcon.js","components/CollectBoard/index.js","components/Dice/index.js","App.js","index.js"],"names":["core_event","EventEmitter","saveGame","boardData","key","val","JSON","stringify","localStorage","setItem","concat","getGame","parse","getItem","getRecord","createRandomNumber","rule","basic","arguments","length","undefined","newArr","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","item","value","num","chance","i","push","err","return","Math","random","createChanceArr","numberToIcon","1","2","4","8","16","32","64","128","256","512","1024","2048","4096","8192","16384","32768","65536","131072","262144","CollectBoard","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","vacentArea","state","blockNum","toggle","prevPos","_this2","_this$state","blocks","map","row","vIndex","hIndex","react_default","a","createElement","className","onClick","handleChess","isArrayEqual","_this3","eventEmitter","Emitter","addListener","recievedNewNumber","v","h","switchChess","setState","currentPos","targetPos","cX","cY","tX","tY","currentValue","targetValue","arrA","arrB","toString","findVacentPos","x","y","result","findIndex","React","Component","Dice","summon","emit","App","Dice_Dice","CollectBoard_CollectBoard","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.4392d782.chunk.js","sourcesContent":["import EventEmitter from \"events\";\nexport default new EventEmitter();","const saveRecord = (key, val) => {\n  localStorage.setItem(`collectGame_${key}`, val)\n}\n\nconst getRecord = (key) => {\n  return localStorage.getItem(`collectGame_${key}`)\n}\n\nexport const saveGame = (boardData) => {\n  saveRecord('testPlayer1', JSON.stringify(boardData))\n}\n\nexport const getGame = (key) => {\n  return JSON.parse(getRecord(key))\n}","const createChanceArr = (rule, basic = 100) => {\n  let newArr = [];\n  for (const item of rule) {\n    const { num, chance } = item;\n    for (let i = 0; i < chance * basic; i++) {\n      newArr.push(num);\n    }\n  }\n  return newArr[~~(Math.random() * newArr.length)];\n}\n\nexport const createRandomNumber = () => {\n  const chanceRule = [\n    { num: 1, chance: 0.55 },\n    { num: 2, chance: 0.3 },\n    { num: 4, chance: 0.1 },\n    { num: 8, chance: 0.05 }\n  ]\n  return createChanceArr(chanceRule)\n}","export const numberToIcon = {\n  '1': 'xiaojitui',\n  '2': 'zhenzi',\n  '4': 'shousimianbao',\n  '8': 'bigenguo',\n  '16': 'yaoguo',\n  '32': 'caomei',\n  '64': 'baocuibinggan',\n  '128': 'naiyouxiaweiyiguo',\n  '256': 'mangguo',\n  '512': 'songzi',\n  '1024': 'banli',\n  '2048': 'baiputaogan',\n  '4096': 'hongzao',\n  '8192': 'huafubing',\n  '16384': 'manyuemeiquqi',\n  '32768': 'shanbei',\n  '65536': 'zhurouchang',\n  '131072': 'kaixinguo',\n  '262144': 'guaziren'\n};\n","import React from 'react';\nimport './index.css'\nimport Emitter from '../../core/event'\nimport { saveGame, getGame } from '../../core/storage'\nimport { createRandomNumber } from '../../core/chance'\nimport { numberToIcon } from './numberToIcon'\n\nexport default class CollectBoard extends React.Component {\n  constructor() {\n    super();\n    this.vacentArea = 9\n    this.state = {\n      blockNum: getGame('testPlayer1') || [\n        [1, 0, 0],\n        [0, 0, 0],\n        [0, 0, 0]\n      ],\n      toggle: 0\n    }\n    this.prevPos = []\n    this.toggle = 0 // 1-拿起  0-放下\n  }\n  render() {\n    const { blockNum, toggle } = this.state;\n    const blocks = blockNum.map((row, vIndex) => (\n      row.map((item, hIndex) => (\n        <div className=\"block\" key={vIndex * 3 + hIndex} onClick={() => this.handleChess(vIndex, hIndex)}>\n          { item ? \n            <span className={`number${this.isArrayEqual(this.prevPos, [vIndex, hIndex]) && toggle ? ' lifted': ''}`}>\n              <i className={`icon ${numberToIcon[item]}`}></i>\n            </span>\n          : '' }\n        </div>))\n    ))\n    return <div className=\"collect-board\">\n      {blocks}\n    </div>\n  }\n  componentDidMount() {\n    this.eventEmitter = Emitter.addListener('sendNumber', val => {\n      this.recievedNewNumber(val);\n    });\n\n    // this.timer = setInterval(() => {\n    //   this.vacentArea === 0 && clearInterval(this.timer)\n    //   this.recievedNewNumber(createRandomNumber())\n    // }, 1000)\n  }\n  handleChess(v, h) {\n    const { toggle } = this.state;\n    toggle ? this.switchChess(this.prevPos, [v, h]) : this.prevPos = [v, h]\n    this.setState({ toggle: !toggle })\n  }\n\n  switchChess(currentPos, targetPos) {\n    if (this.isArrayEqual(currentPos, targetPos)) return // 拿起和放下如果是相同位置 则不处理\n\n    const { blockNum } = this.state;\n    const cX = currentPos[0], cY = [currentPos[1]]\n    const tX = targetPos[0], tY = [targetPos[1]]\n    const currentValue = blockNum[cX][cY], targetValue = blockNum[tX][tY]\n\n    // 相同数字合并，不同数字交换位置\n    blockNum[cX][cY] = currentValue !== targetValue \n        ? [targetValue, blockNum[tX][tY] = currentValue][0]\n        : [0, blockNum[tX][tY] = targetValue + currentValue][0]\n    \n    this.setState({ blockNum })\n    saveGame(blockNum)\n  }\n\n  isArrayEqual(arrA = [], arrB = []) {\n    return arrA.toString() === arrB.toString()\n  }\n\n  recievedNewNumber(val) {\n    const { blockNum } = this.state\n    const vacentPos = this.findVacentPos()\n    if (vacentPos) {\n      const x = this.findVacentPos()[0], y = this.findVacentPos()[1]\n      blockNum[x][y] = val;\n      this.setState({ blockNum })\n    } else {\n      // todo\n      this.vacentArea = 0\n    }\n  }\n  findVacentPos() {\n    const { blockNum } = this.state\n    for (let i in blockNum) {\n      const result = blockNum[i].findIndex(value => value === 0)\n      if(result !== -1) {\n        return [i, result]\n      }\n    }\n  }\n}","import React from 'react';\nimport './index.css';\nimport { createRandomNumber } from '../../core/chance';\nimport Emitter from '../../core/event';\n\nexport default class Dice extends React.Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n  render() {\n    return (\n      <div className=\"dice\" onClick={() => this.summon()}>\n        <i className=\"icon weibolu\" />\n      </div>\n    );\n  }\n  summon() {\n    Emitter.emit('sendNumber', createRandomNumber());\n  }\n}\n","import React from 'react';\nimport CollectBoard from './components/CollectBoard'\nimport Dice from './components/Dice'\nimport './App.css'\nimport './assets/icon.css'\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Dice />\n      <CollectBoard />\n      {/* TODO: 九宫格组件、抽奖、画册 */}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}